# Tauri iOS Development

## Prerequisites

1. **Xcode** (full app, not just Command Line Tools)
2. **iOS Simulator runtimes** (install via Xcode → Settings → Platforms)
3. **Tauri CLI**: `cargo install tauri-cli --version "^2.0.0" --locked`

## Common Issues

### `simctl` not found (exit code 72)

**Symptom:**
```
Error Failed to detect connected iOS Simulator devices
command ["xcrun", "simctl", "list", "--json", "devices", "available"] exited with code 72
```

**Cause:** `xcode-select` is pointing to Command Line Tools instead of full Xcode.

**Fix:**
```bash
# Check current path
xcode-select -p
# If it shows /Library/Developer/CommandLineTools, run:
sudo xcode-select -s /Applications/Xcode.app/Contents/Developer
```

### `cargo: command not found` in Xcode build scripts

**Symptom:**
```
.../Script-*.sh: line 2: cargo: command not found
Command PhaseScriptExecution failed with a nonzero exit code
```

**Cause:** Xcode build scripts don't inherit shell PATH modifications.

**Fix:** This is usually resolved by pointing `xcode-select` to the full Xcode.app (see above). If issues persist, ensure `~/.cargo/bin` is in your system PATH.

### Code signing certificates not found

**Symptom:**
```
Warn No code signing certificates found. You must add one and set the certificate
development team ID on the `bundle > iOS > developmentTeam` config value or the
`APPLE_DEVELOPMENT_TEAM` environment variable.
```

**Fix:**
1. Create an Apple Developer account (free tier works for development)
2. In Xcode, go to Settings → Accounts → Add your Apple ID
3. Set `APPLE_DEVELOPMENT_TEAM` environment variable or configure in `tauri.conf.json`:
   ```json
   {
     "bundle": {
       "iOS": {
         "developmentTeam": "YOUR_TEAM_ID"
       }
     }
   }
   ```

## Running iOS Development

```bash
# Run on iOS Simulator
cargo tauri ios dev

# Run on physical iOS device (requires --host)
cargo tauri ios dev --host

# Open in Xcode for debugging
cargo tauri ios dev --open

# Build for distribution
cargo tauri ios build
```

## Development Server for Physical Devices

When running on physical iOS devices, the dev server must be accessible from the device. The `TAURI_DEV_HOST` environment variable is set by Tauri CLI to the appropriate IP address.

Our `crates/frontend/dev-server.ts` handles this automatically:
```typescript
const HOST = process.env.TAURI_DEV_HOST || "localhost"
```

## Web Inspector (Safari)

1. Enable Safari Developer menu: Safari → Settings → Advanced → "Show features for web developers"
2. On physical devices: Settings → Safari → Advanced → Enable "Web Inspector"
3. Open Develop menu in Safari → Select your device/simulator → localhost

## Generated Files

iOS-specific generated files are in `crates/src-tauri/gen/`:
- `apple/` - Xcode project files (gitignored)
- `schemas/iOS-schema.json` - iOS configuration schema
- `schemas/mobile-schema.json` - Mobile configuration schema

These are regenerated by `cargo tauri ios init` and should not be committed.
